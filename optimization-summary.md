# ä»£ç ä¼˜åŒ–æ€»ç»“

## ğŸ¯ ä¼˜åŒ–ç›®æ ‡

æ¶ˆé™¤é‡å¤çš„å˜é‡å’Œé€»è¾‘ï¼Œæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œä¸€è‡´æ€§ã€‚

## âœ¨ ä¸»è¦ä¼˜åŒ–é¡¹

### 1. ç»Ÿä¸€å˜é‡å‘½å - æ¶ˆé™¤ childPath å’Œ targetRoute é‡å¤

**é—®é¢˜**ï¼š

- `childPath` å’Œ `targetRoute` è¡¨ç¤ºåŒä¸€ä¸ªæ¦‚å¿µï¼ˆå­åº”ç”¨å†…çš„è·¯ç”±è·¯å¾„ï¼‰
- åœ¨é…ç½®å¤„ç†å’Œæ•°æ®ä¼ é€’ä¸­å­˜åœ¨é‡å¤å®šä¹‰

**è§£å†³æ–¹æ¡ˆ**ï¼š

- ç»Ÿä¸€ä½¿ç”¨ `targetRoute` ä½œä¸ºå˜é‡å
- ä¿®æ”¹ `processMenuItems` æ–¹æ³•ä¸­çš„è‡ªåŠ¨æ¨å¯¼é€»è¾‘
- æ›´æ–°ç›¸å…³æ³¨é‡Šå’Œæ–‡æ¡£

**å½±å“æ–‡ä»¶**ï¼š

- `main-app/src/config/index.ts`

### 2. ç§»é™¤é‡å¤çš„ baseUrl å­—æ®µ

**é—®é¢˜**ï¼š

- åœ¨ `getPageInfo` è¿”å›çš„å¯¹è±¡ä¸­åŒæ—¶å­˜åœ¨ `url` å’Œ `baseUrl`
- ä¸¤è€…éƒ½è¡¨ç¤ºå­åº”ç”¨çš„åŸºç¡€ URLï¼Œé€ æˆæ•°æ®å†—ä½™

**è§£å†³æ–¹æ¡ˆ**ï¼š

- ä¿ç•™ `url` å­—æ®µï¼ˆmicro-app ç»„ä»¶éœ€è¦ï¼‰
- ç§»é™¤ `baseUrl` å­—æ®µ
- åœ¨ layout.vue ä¸­ä¹Ÿç§»é™¤å¯¹ `baseUrl` çš„è§£æ„

**å½±å“æ–‡ä»¶**ï¼š

- `main-app/src/config/index.ts`
- `main-app/src/views/layout.vue`

### 3. æå–å…¬å…±è·¯ç”±ç›‘å¬é€»è¾‘

**é—®é¢˜**ï¼š

- `child-one` å’Œ `child-two` ä¸­å­˜åœ¨å®Œå…¨ç›¸åŒçš„è·¯ç”±ç›‘å¬å’Œè·³è½¬é€»è¾‘
- ä»£ç é‡å¤ï¼Œç»´æŠ¤å›°éš¾

**è§£å†³æ–¹æ¡ˆ**ï¼š

- åˆ›å»ºé€šç”¨çš„ `micro-app-router.ts` å·¥å…·æ–‡ä»¶
- æä¾› `setupMicroAppRouting` å’Œ `handleRouteChange` å‡½æ•°
- ç®€åŒ–å­åº”ç”¨çš„ `main.ts` æ–‡ä»¶

**æ–°å¢æ–‡ä»¶**ï¼š

- `child-one/src/utils/micro-app-router.ts`
- `child-two/src/utils/micro-app-router.ts`

**å½±å“æ–‡ä»¶**ï¼š

- `child-one/src/main.ts`
- `child-two/src/main.ts`

## ğŸ“Š ä¼˜åŒ–æ•ˆæœ

### ä»£ç è¡Œæ•°å‡å°‘

- `child-one/src/main.ts`: ä» 61 è¡Œå‡å°‘åˆ° 19 è¡Œ (-69%)
- `child-two/src/main.ts`: ä» 61 è¡Œå‡å°‘åˆ° 19 è¡Œ (-69%)

### ç»´æŠ¤æ€§æå‡

- **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªå˜é‡éƒ½æœ‰æ˜ç¡®çš„å«ä¹‰
- **DRY åŸåˆ™**ï¼šæ¶ˆé™¤äº†é‡å¤ä»£ç 
- **å¯å¤ç”¨æ€§**ï¼šè·¯ç”±ç›‘å¬é€»è¾‘å¯è¢«å…¶ä»–å­åº”ç”¨å¤ç”¨

### ä¸€è‡´æ€§æ”¹è¿›

- **å‘½åç»Ÿä¸€**ï¼šæ‰€æœ‰åœ°æ–¹éƒ½ä½¿ç”¨ `targetRoute`
- **æ•°æ®ç»“æ„ç®€åŒ–**ï¼šç§»é™¤å†—ä½™å­—æ®µ
- **é€»è¾‘ç»Ÿä¸€**ï¼šæ‰€æœ‰å­åº”ç”¨ä½¿ç”¨ç›¸åŒçš„è·¯ç”±å¤„ç†é€»è¾‘

## ğŸ”§ ä¼˜åŒ–å‰åå¯¹æ¯”

### é…ç½®å¯¹è±¡ç»“æ„

**ä¼˜åŒ–å‰**ï¼š

```typescript
{
  type: 'micro',
  appName: 'child-one',
  name: 'child-one',
  url: 'http://localhost:8001',
  targetRoute: '/home',
  baseUrl: 'http://localhost:8001', // é‡å¤
  childPath: '/home',              // é‡å¤
  iframe: true,
  keepAlive: true
}
```

**ä¼˜åŒ–å**ï¼š

```typescript
{
  type: 'micro',
  appName: 'child-one',
  name: 'child-one',
  url: 'http://localhost:8001',
  targetRoute: '/home',           // ç»Ÿä¸€ä½¿ç”¨
  iframe: true,
  keepAlive: true
}
```

### å­åº”ç”¨è·¯ç”±ç›‘å¬

**ä¼˜åŒ–å‰**ï¼š

```typescript
// æ¯ä¸ªå­åº”ç”¨éƒ½æœ‰40+è¡Œé‡å¤çš„ç›‘å¬é€»è¾‘
if (window.__MICRO_APP_ENVIRONMENT__) {
  // ... å¤§é‡é‡å¤ä»£ç 
}
```

**ä¼˜åŒ–å**ï¼š

```typescript
// ç®€æ´çš„ä¸€è¡Œè°ƒç”¨
setupMicroAppRouting(router, 'child-one')
```

## ğŸš€ åç»­å»ºè®®

1. **ç±»å‹å®‰å…¨**ï¼šä¸ºå·¥å…·å‡½æ•°æ·»åŠ æ›´ä¸¥æ ¼çš„ TypeScript ç±»å‹
2. **é”™è¯¯å¤„ç†**ï¼šå¢å¼ºè·¯ç”±è·³è½¬çš„é”™è¯¯å¤„ç†æœºåˆ¶
3. **æ€§èƒ½ä¼˜åŒ–**ï¼šè€ƒè™‘ä½¿ç”¨é˜²æŠ–æ¥é¿å…é¢‘ç¹çš„è·¯ç”±åˆ‡æ¢
4. **å•å…ƒæµ‹è¯•**ï¼šä¸ºæ–°çš„å·¥å…·å‡½æ•°ç¼–å†™å•å…ƒæµ‹è¯•

## ğŸ“ å˜æ›´æ¸…å•

- [x] ç»Ÿä¸€ä½¿ç”¨ `targetRoute` æ›¿æ¢ `childPath`
- [x] ç§»é™¤é‡å¤çš„ `baseUrl` å­—æ®µ
- [x] æå–å…¬å…±è·¯ç”±ç›‘å¬é€»è¾‘åˆ°å·¥å…·å‡½æ•°
- [x] ç®€åŒ–å­åº”ç”¨çš„ `main.ts` æ–‡ä»¶
- [x] æ›´æ–°ç›¸å…³æ³¨é‡Šå’Œæ–‡æ¡£
